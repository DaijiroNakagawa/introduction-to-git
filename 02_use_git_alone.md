## ひとりで使うgit

さて、git がどんなものなのか、だいたいわかったでしょうか。というわけで、まずは、ひとりで git を使ってみましょう。

## まずはリポジトリを作ろう

なにはともあれ、まずはリポジトリを作らなくては話ははじまりません。リポジトリを作りましょう。

    $ mkdir my_first_workspace
    $ cd my_first_workspace
    $ git init

$ mkdir my_first_workspace で、 my_first_workspace という「作業ディレクトリ」を作りました。$ cd my_first_workspace で、そのディレクトリに入りました。そこで、$ git init をすることで、この作業ディレクトリに対応するリポジトリを作成しています。

「作業ディレクトリ」と「リポジトリ」の関係は頭に入ってますか？ 頭に入ってないひとは [VCS入門](https://github.com/masaru-b-cl/introduction-to-vcs/blob/master/readme.md) をおさらいしましょう。

さて、これで、「作業ディレクトリ」と「リポジトリ」が出来上がりました。が、リポジトリは一体どこにつくられたのでしょうか？my_first_workspace ディレクトリにいる状態で、

    $ ls -a

としてみましょう。すると、下記のように、".git" というディレクトリが存在しているのが見て取れると思います(ちなみに、 "." というのは現在のディレクトリ を指し、 ".." というのは一個うえのディレクトリのことです)。

    $ ls -a
    .    ..   .git
 
この ".git" ディレクトリが、「リポジトリ」の正体です。workspace という「作業ディレクトリ」があるとき、その作業ディレクトリに対応する「リポジトリ」は、 workspace/.git である、ということですね。
 
今はコマンドラインから見てみましたが、ファイラーから見てみましょう(ここから先は mac 環境であることを前提とします)。Finder で、my_first_workspace ディレクトリを開いてみましょう。
 
あれっ！？ ".git" が無いように見えますね！？ これは、 "." から始まるファイルやディレクトリは「隠しファイル」であるせいです。隠しファイルは、Finderからは見えなくなっています。大切な設定情報などが書き込まれているファイルは、誤操作で消してしまったりしないように、"." から始まる「隠しファイル」とされることが多いです。誤操作でリポジトリがふっとんじゃった！なんてことになったら、目もあてられないので、リポジトリは隠しファイルとなっているわけですね。Finder から隠しファイルを見れるようにする方法もあるのですが、ここでは脇道にそれてしまうため触れません。
 
とにかく、これで、「作業ディレクトリ」の "my_first_workspace" と、それに対応する「リポジトリ」である ".git" が出来上がりました。この「作業ディレクトリ」の中で編集されるファイル群が、「作業コピー」となります。

ちなみに、作業コピーの内容をリポジトリに登録することを、「コミット」と言いますので、覚えておきましょう。

## 作業ディレクトリで作業をしよう

まずは、作業ディレクトリの中になにかファイルを作って見ましょう。どのようなやり方でもかまいません。いまはとりあえず

    nyan

と書かれた nyan.txt というファイルを作業ディレクトリ内に作ってください。

作りましたか？

これで、「リポジトリに反映されていない作業コピー」が「作業ディレクトリ内」に保できあがりました。その様子を見てみましょう。ターミナルで作業ディレクトリに入って、現在の「リポジトリと作業コピーの状態」を見てみましょう

    $ cd path/to/my_first_workspace
    $ git status

path/to/my_first_workspace はおのおの自分が my_first_workspace を作ったパスに読み替えてください。

さて、上記のようにコマンドを打ってみると、

    # On branch master
    #
    # Initial commit
    #
    # Untracked files:
    #   (use "git add <file>..." to include in what will be committed)
    #
    #	nyan.txt
    nothing added to commit but untracked files present (use "git add" to track)

というような表示が出てきたかと思います。「ウワァ英語だ！助けて！」みたいにならないでください。少なくとも中学で3年間、多くのひとはそのあと高校で3年間はみっちり英語習ってきたでしょう。これくらいは読みましょう。

まず上から見ていきましょう。"On branch master"とありますね。「ブランチ master 上だよ」と言っています。ブランチについて説明していないので、いまはこれは無視してかまいません。

そのあとに Initial commit と書かれていますね。「最初のコミットだよ」と書かれています。まだ一度もコミットしていないので、「この作業コピーをコミットするとこれが最初のコミットになるよ」って意味です。

そのあと、"Untracked files" と書かれていますね。「トラックされていないファイルたちだよ」と言っています、このトラックは、「追跡する」の意味ですね。つまり、「追跡されてないファイルだよ」という意味です。「追跡されていない」とはどういうことでしょうか。だれが追跡していないのでしょうか。

これは、「作業コピーにこういうファイルがあるけど、リポジトリはそれを追跡してないよ」という意味です。つまり、リポジトリさんが、「なんか知らんファイルあるよ、おれこれ知らんよ」って言ってるわけですね。括弧の中はいったん飛ばして、その下を見てみると、先ほど作った nyan.txt が書かれています。新しく作ったファイルだから、「おれこれ知らないファイルなんだけどいいの？」とリポジトリさんが言ってくれてるのですね。

では、括弧の中を見てみましょう。 use "git add <file> ..." to include in what will be committed と書かれています。なんて親切な git さん、「知らんファイルあるんだけどさ、これもコミットしたいなら git add <file> ってやってくれればいいよ」と教えてくれています。

最後に、nothing added to commit but untracked files present (use "git add" to track) と書かれていますね。「コミットするものがなにもないよ、でも追跡されてないファイルがあるよ(追跡したければ git add するといいよ)」と説明してくれています。

英語、ちゃんと読めば、これだけ丁寧に情報が書かれているんです。たまに「なんか表示されたけど英語だから読まなかったです」みたいなひといるけど、読んでください。ググるまでもなく、ひとに聞くまでもなく、ちゃんと読めばちゃんと情報が出ているんです。

さて、上記をまとめると、「nyan.txt」っていうファイルが作業コピー内にあるけど、リポジトリはそのファイルのこと追跡してないよ状態になっているわけですね。

## 作業ディレクトリで作業をしよう、の落ち穂拾い

さて、さきほど $ git status を打ったときの出力ですが、

    # On branch master
    #
    # Initial commit
    #
    # Untracked files:
    #   (use "git add <file>..." to include in what will be committed)
    #
    #	.DS_Store
    #	nyan.txt
    nothing added to commit but untracked files present (use "git add" to track)
    
という感じで、身に覚えない .DS_Store というファイルが「untracked files」として表示されてしまったひともいるかもしれません。この .DS_Store というファイルは、mac OS が勝手に作る、「このフォルダのアイコンの並び順はこんな感じで表示サイズはこのくらい」みたいな情報が入ったファイルです。このファイルは、リポジトリで管理する必要のないファイルですね。むしろ、このファイルはそれぞれの環境によって異なる内容になるので、リポジトリで管理すると無用なトラブルのもとになります。こういうときには、「.DS_Storeっていうファイル、無視してね」と git に教えてあげましょう。その方法はふたつあります。

1. .gitignore という、「このファイルはこのリポジトリでは無視してね」を書いたファイルをリポジトリに作成する
2. どのリポジトリでも .DS_Store という名前のファイルを無視するように git を設定する

「このリポジトリでは無視したいファイルなんだけどグローバルに無視したいわけではない」みたいなファイルは .gitignore に書く方法がいいでしょうし、どんな場合にも無視してほしいようなファイルに関してはグローバルに無視する設定をしたほうがいいでしょう。今回の .DS_Store はどんな場合にもリポジトリ管理したくない類いのものだと思いますので、今回はその方法を取りましょう。ターミナルを開いて、以下のコマンドを打ってください。

    $ git config --global core.excludesfile ~/.gitignore_global
    $ echo ".DS_Store" >> ~/.gitignore_global

一行目で、「グローバルに無視するファイル名を書いたファイルは ~/.gitignore_global というファイルだよ」とgitに教えてあげています。二行目で、そのファイルに ".DS_Store" を書き込み、gitに「.DS_Store」は無視してねと教えています。

.gitignoreファイルの書き方には触れないので、グーグル先生に聞いてください。

さて、ここで再度

    $ git status

してみましょう。今度は、.DS_Store が「untracking files」から消えて、git が完全にその存在を無視していることが見て取れるでしょう。

## 作業コピーの内容を track してもらう

さて、作業コピーで新しいファイルを作った状態では、そのファイルは untracking な状態でした。では、この untracking な状態のファイルを、リポジトリに track してもらいましょう。その方法をあなたはもう知っているはずです。そうです。 git add ですね。ではやってみましょう。

    $ git add nyan.txt

これで、「nyan.txtを track してね」とリポジトリに伝える事ができました。ではここで再度 git status してみましょう。

    $ git status
    # On branch master
    #
    # Initial commit
    #
    # Changes to be committed:
    #   (use "git rm --cached <file>..." to unstage)
    #
    #	new file:   nyan.txt
    #

このような出力が得られたかと思います。ちょっと内容が変わってますね。英語だけど頑張って読んでみましょう。

Initial commit のところまではいいでしょう。その下、Changes to be committed: と書かれていますね。これはそのまま、「コミットされる変更だよ」です。つまり、この状態でコミットをすると、その下に書かれた内容がコミットされるよ、ということですね。括弧を飛ばしてみて見ると、new file: nyan.txt と書かれています。つまり、この状態でコミットをすると「新しく nyan.txt というファイルが作られたよ」という変更内容がコミットされるよ！ということですね。いい感じです！

括弧のなかにはなんて書いてあるでしょうか。 use "git rm --cached <file>..." to unstage ですね。「unstage するには、 "git rm --cached <file>..." ってすればいいよ」とのことです。ん？ 新しい疑問が生まれましたね。unstageとはなんでしょうか。では stage unstage について説明しましょう。

## stage とは unstage とは

git では、作業ディレクトリで作業コピーに編集を加えたものを、そのまま直にリポジトリにコミットすることができません。コミットするときには、かならず、「あ、このファイルはコミット(リポジトリに変更を反映)してほしいファイルね。このファイルは編集してあるんだけどまだリポジトリに反映したくないからコミットしないで」みたいな感じで、「どの変更内容はコミットするけどどの変更内容はコミットしない」みたいなのを先に git に教えておく必要があります。このときgitに教えてあげた「次コミットするときにリポジトリに反映される内容」の置き場のことを、stage と呼んでいます。

つまり、さっき git add nyan.txt としたことで、nyan.txtはその内容が「staging された」ことになります。ではunstage とは？もうお分かりでしょう。「stage」が「これはコミットしてほしい変更内容ね」と git に教えることなので、その逆、「あっやっぱこの変更内容は次のコミットでコミットすんのやめて」と git に教えることになるわkです。では、実際にやってみましょう。 use "git rm --cached <file>..." to unstage でしたね。今回は nyan.txt をunstageするので、以下のようになります。

    $ git rm --cached nyan.txt

はい、ではここでもう一度 git status で状態を見てみましょう

    $ git status
    # On branch master
    #
    # Initial commit
    #
    # Untracked files:
    #   (use "git add <file>..." to include in what will be committed)
    #
    #	nyan.txt
    nothing added to commit but untracked files present (use "git add" to track)
    
おおー。nyna.txt が Untracked files に戻っていますね。

こんな感じで、git に「作業ディレクトリで作業コピーにたいして行った変更のうち、どの変更をコミットするのか、あるいはしないのか」を教えて上げることができます。では、とりあえず今回は再度 nyan.txt を stage に上げておきましょう。

    $ git add nyan.txt
    
    $ git status
    # On branch master
    #
    # Initial commit
    #
    # Changes to be committed:
    #   (use "git rm --cached <file>..." to unstage)
    #
    #	new file:   nyan.txt
    #
